{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst apiKey = '41588863-34d6c5c01e7f0c7c667666520';\n\nconst searchInput = document.querySelector('#search-input');\nconst imageContainer = document.querySelector('#image-container');\nconst loader = document.querySelector('.loader');\nconst form = document.querySelector('#search-form');\nconst lightbox = new SimpleLightbox('#image-container a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nconst loadMoreButton = document.querySelector('.load-more-btn');\nconst state = {\n  currentPage: 1,\n  totalHits: 0,\n  query: '',\n};\n\nlet cardHeight;\n\nform.addEventListener('submit', onFormSubmit);\nloadMoreButton.addEventListener('click', onClickLoadBtn);\n\nfunction onFormSubmit(event) {\n  event.preventDefault();\n  state.query = searchInput.value.trim();\n\n  if (!state.query) {\n    clearImages();\n    hideLoadMoreButton();\n    return;\n  }\n\n  loader.style.display = 'block';\n  const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${state.query}&image_type=photo&orientation=horizontal&safesearch=true&page=${state.currentPage}&per_page=40`;\n\n  axios\n    .get(apiUrl)\n    .then(response => {\n      const data = response.data;\n\n      loader.style.display = 'none';\n      if (Array.isArray(data.hits) && data.hits.length > 0) {\n        state.totalHits = data.totalHits;\n        renderImages(data.hits);\n        lightbox.refresh();\n        searchInput.value = '';\n        setTimeout(() => {\n          showLoadMoreButton();\n        }, 0);\n        state.currentPage++;\n      } else {\n        clearImages();\n        hideLoadMoreButton();\n        if (state.totalHits === 0) {\n          iziToast.show({\n            message:\n              'Sorry, there are no images matching your search query. Please try again!',\n            messageColor: 'white',\n            backgroundColor: 'red',\n            position: 'topRight',\n          });\n        } else {\n          iziToast.show({\n            message:\n              \"We're sorry, but you've reached the end of search results.\",\n            messageColor: 'white',\n            backgroundColor: 'orange',\n            position: 'topRight',\n          });\n          searchInput.value = '';\n          state.currentPage = 1;\n        }\n      }\n    })\n    .catch(error => {\n      loader.style.display = 'none';\n      console.error('Error!', error);\n    });\n}\n\nfunction renderImages(images) {\n  images.map(image => {\n    const imageCard = `\n      <div class=\"image-card\">\n        <a href=\"${image.largeImageURL}\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n          <div class=\"image-info\">\n            <p><strong>Likes:</strong> ${image.likes}</p>\n            <p><strong>Views:</strong> ${image.views}</p>\n            <p><strong>Comments:</strong> ${image.comments}</p>\n            <p><strong>Downloads:</strong> ${image.downloads}</p>\n          </div>\n        </a>\n      </div>\n    `;\n    imageContainer.innerHTML += imageCard;\n  });\n  const firstImageCard = document.querySelector('.image-card');\n  if (firstImageCard) {\n    cardHeight = firstImageCard.getBoundingClientRect().height;\n  }\n}\n\nfunction clearImages() {\n  imageContainer.innerHTML = '';\n}\n\nfunction showLoadMoreButton() {\n  loadMoreButton.style.display = 'block';\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreButton.style.display = 'none';\n}\n\nfunction onClickLoadBtn() {\n  state.query = searchInput.value.trim();\n\n  if (state.currentPage <= Math.ceil(state.totalHits / 40)) {\n    loader.style.display = 'block';\n    const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${state.query}&image_type=photo&orientation=horizontal&safesearch=true&page=${state.currentPage}&per_page=40`;\n\n    axios\n      .get(apiUrl)\n      .then(response => {\n        const data = response.data;\n\n        loader.style.display = 'none';\n\n        if (Array.isArray(data.hits) && data.hits.length > 0) {\n          renderImages(data.hits);\n          lightbox.refresh();\n          state.currentPage++;\n          const firstImageCard = document.querySelector('.image-card');\n          if (firstImageCard) {\n            cardHeight = firstImageCard.getBoundingClientRect().height;\n            scrollCards(cardHeight * 2);\n          }\n\n          setTimeout(() => {\n            showLoadMoreButton();\n          }, 0);\n        }\n      })\n      .catch(error => {\n        loader.style.display = 'none';\n        console.error('Error!', error);\n      });\n  } else {\n    hideLoadMoreButton();\n    iziToast.show({\n      message: `We're sorry, but you've reached the end of search results.`,\n      messageColor: 'white',\n      backgroundColor: 'orange',\n      position: 'topRight',\n    });\n  }\n}\n\nfunction scrollCards(height) {\n  const firstImageCard = document.querySelector('.image-card');\n  if (firstImageCard) {\n    window.scrollBy({\n      top: height,\n      left: 0,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["apiKey","searchInput","imageContainer","loader","form","lightbox","SimpleLightbox","loadMoreButton","state","cardHeight","onFormSubmit","onClickLoadBtn","event","clearImages","hideLoadMoreButton","apiUrl","axios","response","data","renderImages","showLoadMoreButton","iziToast","error","images","image","imageCard","firstImageCard","scrollCards","height"],"mappings":"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"}