{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst apiKey = '41588863-34d6c5c01e7f0c7c667666520';\n\nconst searchInput = document.querySelector('#search-input');\nconst imageContainer = document.querySelector('#image-container');\nconst loader = document.querySelector('.loader');\nconst form = document.querySelector('#search-form');\nconst lightbox = new SimpleLightbox('#image-container a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nconst loadMoreButton = document.querySelector('.load-more-btn');\nconst state = {\n  currentPage: 1,\n  totalHits: 0,\n  query: '',\n  currentQuery: '',\n};\n\nlet cardHeight;\n\nform.addEventListener('submit', onFormSubmit);\nloadMoreButton.addEventListener('click', onClickLoadBtn);\n\nasync function onFormSubmit(event) {\n  event.preventDefault();\n\n  const newQuery = searchInput.value.trim();\n\n  if (!newQuery) {\n    hideLoadMoreButton();\n    return;\n  }\n\n  loader.style.display = 'block';\n\n  if (newQuery !== state.currentQuery) {\n    clearImages();\n    state.currentQuery = newQuery;\n    state.currentPage = 1;\n  }\n\n  const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${state.currentQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${state.currentPage}&per_page=40`;\n  try {\n    const response = await axios.get(apiUrl);\n    const data = response.data;\n\n    loader.style.display = 'none';\n    if (Array.isArray(data.hits) && data.hits.length > 0) {\n      state.totalHits = data.totalHits;\n      clearImages();\n      if (state.currentPage <= Math.ceil(state.totalHits / 40)) {\n        showLoadMoreButton();\n      }\n      renderImages(data.hits);\n\n      lightbox.refresh();\n      searchInput.value = '';\n      state.currentPage++;\n    } else {\n      hideLoadMoreButton();\n      if (state.totalHits === 0) {\n        iziToast.show({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          messageColor: 'white',\n          backgroundColor: 'red',\n          position: 'topRight',\n        });\n      } else {\n        iziToast.show({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          messageColor: 'white',\n          backgroundColor: 'orange',\n          position: 'topRight',\n        });\n        searchInput.value = '';\n        state.currentPage = 1;\n      }\n    }\n  } catch (error) {\n    loader.style.display = 'none';\n    console.error('Error!', error);\n  }\n  state.currentPage = 1;\n  state.query = state.currentQuery;\n}\n\nfunction renderImages(images) {\n  clearImages();\n  images.map(image => {\n    const imageCard = `\n      <div class=\"image-card\">\n        <a href=\"${image.largeImageURL}\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n          <div class=\"image-info\">\n            <p><strong>Likes:</strong> ${image.likes}</p>\n            <p><strong>Views:</strong> ${image.views}</p>\n            <p><strong>Comments:</strong> ${image.comments}</p>\n            <p><strong>Downloads:</strong> ${image.downloads}</p>\n          </div>\n        </a>\n      </div>\n    `;\n    imageContainer.innerHTML += imageCard;\n  });\n  const firstImageCard = document.querySelector('.image-card');\n  if (firstImageCard) {\n    cardHeight = firstImageCard.getBoundingClientRect().height;\n  }\n}\n\nfunction clearImages() {\n  if (state.query !== state.currentQuery) {\n    imageContainer.innerHTML = '';\n  }\n}\n\nfunction showLoadMoreButton() {\n  loadMoreButton.style.display = 'block';\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreButton.style.display = 'none';\n}\n\nasync function onClickLoadBtn() {\n  state.query = state.currentQuery;\n\n  loader.style.display = 'block';\n  const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${state.currentQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${state.currentPage}&per_page=40`;\n\n  try {\n    const response = await axios.get(apiUrl);\n    const data = response.data;\n\n    loader.style.display = 'none';\n\n    if (Array.isArray(data.hits) && data.hits.length > 0) {\n      renderImages(data.hits);\n\n      lightbox.refresh();\n\n      const firstImageCard = document.querySelector('.image-card');\n      if (firstImageCard) {\n        cardHeight = firstImageCard.getBoundingClientRect().height;\n        scrollCards(cardHeight * 2);\n      }\n      state.currentPage++;\n      if (state.currentPage <= Math.ceil(state.totalHits / 40)) {\n        showLoadMoreButton();\n      } else {\n        hideLoadMoreButton();\n        iziToast.show({\n          message: `We're sorry, but you've reached the end of search results.`,\n          messageColor: 'white',\n          backgroundColor: 'orange',\n          position: 'topRight',\n        });\n      }\n    }\n  } catch (error) {\n    loader.style.display = 'none';\n    console.error('Error!', error);\n  }\n}\n\nfunction scrollCards(height) {\n  const firstImageCard = document.querySelector('.image-card');\n  if (firstImageCard) {\n    window.scrollBy({\n      top: height,\n      left: 0,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["apiKey","searchInput","imageContainer","loader","form","lightbox","SimpleLightbox","loadMoreButton","state","cardHeight","onFormSubmit","onClickLoadBtn","event","newQuery","hideLoadMoreButton","clearImages","apiUrl","data","axios","showLoadMoreButton","renderImages","iziToast","error","images","image","imageCard","firstImageCard","scrollCards","height"],"mappings":"owBAMA,MAAMA,EAAS,qCAETC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAiB,SAAS,cAAc,kBAAkB,EAC1DC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAW,IAAIC,EAAe,qBAAsB,CACxD,aAAc,MACd,aAAc,GAChB,CAAC,EACKC,EAAiB,SAAS,cAAc,gBAAgB,EACxDC,EAAQ,CACZ,YAAa,EACb,UAAW,EACX,MAAO,GACP,aAAc,EAChB,EAEA,IAAIC,EAEJL,EAAK,iBAAiB,SAAUM,CAAY,EAC5CH,EAAe,iBAAiB,QAASI,CAAc,EAEvD,eAAeD,EAAaE,EAAO,CACjCA,EAAM,eAAc,EAEpB,MAAMC,EAAWZ,EAAY,MAAM,KAAI,EAEvC,GAAI,CAACY,EAAU,CACbC,IACA,MACD,CAEDX,EAAO,MAAM,QAAU,QAEnBU,IAAaL,EAAM,eACrBO,IACAP,EAAM,aAAeK,EACrBL,EAAM,YAAc,GAGtB,MAAMQ,EAAS,gCAAgChB,OAAYQ,EAAM,6EAA6EA,EAAM,0BACpJ,GAAI,CAEF,MAAMS,GADW,MAAMC,EAAM,IAAIF,CAAM,GACjB,KAEtBb,EAAO,MAAM,QAAU,OACnB,MAAM,QAAQc,EAAK,IAAI,GAAKA,EAAK,KAAK,OAAS,GACjDT,EAAM,UAAYS,EAAK,UACvBF,IACIP,EAAM,aAAe,KAAK,KAAKA,EAAM,UAAY,EAAE,GACrDW,IAEFC,EAAaH,EAAK,IAAI,EAEtBZ,EAAS,QAAO,EAChBJ,EAAY,MAAQ,GACpBO,EAAM,gBAENM,IACIN,EAAM,YAAc,EACtBa,EAAS,KAAK,CACZ,QACE,2EACF,aAAc,QACd,gBAAiB,MACjB,SAAU,UACpB,CAAS,GAEDA,EAAS,KAAK,CACZ,QAAS,6DACT,aAAc,QACd,gBAAiB,SACjB,SAAU,UACpB,CAAS,EACDpB,EAAY,MAAQ,GACpBO,EAAM,YAAc,GAGzB,OAAQc,EAAP,CACAnB,EAAO,MAAM,QAAU,OACvB,QAAQ,MAAM,SAAUmB,CAAK,CAC9B,CACDd,EAAM,YAAc,EACpBA,EAAM,MAAQA,EAAM,YACtB,CAEA,SAASY,EAAaG,EAAQ,CAC5BR,IACAQ,EAAO,IAAIC,GAAS,CAClB,MAAMC,EAAY;AAAA;AAAA,mBAEHD,EAAM;AAAA,sBACHA,EAAM,sBAAsBA,EAAM;AAAA;AAAA,yCAEfA,EAAM;AAAA,yCACNA,EAAM;AAAA,4CACHA,EAAM;AAAA,6CACLA,EAAM;AAAA;AAAA;AAAA;AAAA,MAK/CtB,EAAe,WAAauB,CAChC,CAAG,EACD,MAAMC,EAAiB,SAAS,cAAc,aAAa,EACvDA,IACFjB,EAAaiB,EAAe,sBAAuB,EAAC,OAExD,CAEA,SAASX,GAAc,CACjBP,EAAM,QAAUA,EAAM,eACxBN,EAAe,UAAY,GAE/B,CAEA,SAASiB,GAAqB,CAC5BZ,EAAe,MAAM,QAAU,OACjC,CAEA,SAASO,GAAqB,CAC5BP,EAAe,MAAM,QAAU,MACjC,CAEA,eAAeI,GAAiB,CAC9BH,EAAM,MAAQA,EAAM,aAEpBL,EAAO,MAAM,QAAU,QACvB,MAAMa,EAAS,gCAAgChB,OAAYQ,EAAM,6EAA6EA,EAAM,0BAEpJ,GAAI,CAEF,MAAMS,GADW,MAAMC,EAAM,IAAIF,CAAM,GACjB,KAItB,GAFAb,EAAO,MAAM,QAAU,OAEnB,MAAM,QAAQc,EAAK,IAAI,GAAKA,EAAK,KAAK,OAAS,EAAG,CACpDG,EAAaH,EAAK,IAAI,EAEtBZ,EAAS,QAAO,EAEhB,MAAMqB,EAAiB,SAAS,cAAc,aAAa,EACvDA,IACFjB,EAAaiB,EAAe,sBAAuB,EAAC,OACpDC,EAAYlB,EAAa,CAAC,GAE5BD,EAAM,cACFA,EAAM,aAAe,KAAK,KAAKA,EAAM,UAAY,EAAE,EACrDW,KAEAL,IACAO,EAAS,KAAK,CACZ,QAAS,6DACT,aAAc,QACd,gBAAiB,SACjB,SAAU,UACpB,CAAS,EAEJ,CACF,OAAQC,EAAP,CACAnB,EAAO,MAAM,QAAU,OACvB,QAAQ,MAAM,SAAUmB,CAAK,CAC9B,CACH,CAEA,SAASK,EAAYC,EAAQ,CACJ,SAAS,cAAc,aAAa,GAEzD,OAAO,SAAS,CACd,IAAKA,EACL,KAAM,EACN,SAAU,QAChB,CAAK,CAEL"}